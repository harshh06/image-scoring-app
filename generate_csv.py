import pandas as pd
import re

# Raw data copied from your message
raw_data = """
S-3349-01,2,1.5,1.5,2
S-3349-02,3.5,2.5,2.5,3.5
S-3349-03,2.5,1.5,1.5,2.5
S-3349-04,2,1.5,1.5,2
S-3349-05,2,1.5,1.5,2
S-3349-06,1.5,1,1,1.5
S-3349-07,2.5,1.5,1.5,2.5
S-3349-08,2.5,1.5,1.5,2.5
S-3349-09,3.5,2.5,2.5,3.5
S-3349-10,3,2,2,3
S-3349-11,3.5,2.5,2.5,3.5
S-3349-12,3.5,2.5,2.5,3.5
S-3350-01,3.5,2.5,2.5,3.5
S-3350-02,3,2,2,3
S-3350-03,2.5,1.5,1.5,2.5
S-3350-04,4,3,3,4
S-3350-05,4,3,3,4
S-3350-06,4,3,3,4
S-3350-07,4,3,3,4
S-3350-08,1.5,1,1,1.5
S-3350-09,2,1.5,1.5,2
S-3350-10,2.5,1.5,1.5,2.5
S-3350-11,3,2,2,3
S-3350-12,2.5,1.5,1.5,2.5
S-3350-13,3,2,2,3
S-3350-14,3.5,2.5,2.5,3.5
S-3350-15,3.5,2.5,2.5,3.5
S-3351-01,3,2,2,3
S-3351-02,3.5,2.5,2.5,3.5
S-3351-03,2.5,1.5,1.5,2.5
S-3351-04,4,3,3,4
S-3351-05,4,3,3,4
S-3351-06,3,2,2,3
S-3351-07,3.5,2.5,2.5,3.5
S-3351-08,3.5,2.5,2.5,3.5
S-3351-09,3.5,2.5,2.5,3.5
S-3351-10,4,3,3,4
S-3351-11,3.5,2.5,2.5,3.5
S-3351-12,2.5,1.5,1.5,2.5
S-3351-13,2,1.5,1.5,2
S-3351-14,2,1.5,1.5,2
S-3351-15,3.5,2.5,2.5,3.5
S-3352-01,2.5,1.5,1.5,2
S-3352-02,2.5,1.5,1.5,2
S-3352-03,2.5,1.5,1.5,2
S-3352-04,2.5,1.5,1.5,2
S-3352-05,3,2,2,3
S-3352-06,3,2,2,3
S-3352-07,3.5,2.5,2.5,3.5
S-3352-08,3.5,2.5,2.5,3.5
S-3352-09,4,3,3,4
S-3352-10,3.5,2.5,2.5,3.5
S-3353-01,4,3,3,4
S-3353-02,4,3,3,4
S-3353-03,3.5,2.5,2.5,3.5
S-3353-04,3.5,2.5,2.5,3.5
S-3353-05,4,3,3,4
S-3353-06,4,3,3,4
S-3353-07,4,3,3,4
S-3354-01,3,2,2,3
S-3354-02,4,3,3,4
S-3354-03,4,3,3,4
S-3354-04,4,3,3,4
S-3354-05,4,3,3,4
S-3354-06,4,3,3,4
S-3354-07,4,3,3,4
S-3354-08,4,3,3,4
S-3355-01,3,2,2,3
S-3355-02,2.5,1.5,1.5,2.5
S-3355-03,2.5,1.5,1.5,2.5
S-3355-04,2.5,1.5,1.5,2.5
S-3355-05,2.5,1.5,1.5,2.5
S-3355-06,3,2,2,3
S-3355-07,3.5,2.5,2.5,3.5
S-3355-08,3.5,2.5,2.5,3.5
S-3355-09,3.5,2.5,2.5,3.5
S-3355-10,2.5,1.5,1.5,2.5
S-3355-11,2.5,1.5,1.5,2.5
S-3355-12,2.5,1.5,1.5,2.5
S-3355-13,3.5,2.5,2.5,3.5
S-3355-14,1.5,1,1,1.5
S-3355-15,1.5,1,1,1.5
S-3356-01,3.5,2.5,2.5,3.5
S-3356-02,3,2,2,3
S-3356-03,3,2,2,3
S-3356-04,2.5,1.5,1.5,2.5
S-3356-05,2.5,1.5,1.5,2.5
S-3356-06,2.5,1.5,1.5,2.5
S-3356-07,4,3,3,4
S-3356-08,3,2,2,3
S-3356-09,3.5,2.5,2.5,3.5
S-3356-10,2.5,1.5,1.5,2.5
S-3356-11,2.5,1.5,1.5,2.5
S-3356-12,3.5,2.5,2.5,3.5
S-3356-13,3.5,2.5,2.5,3.5
S-3356-14,3.5,2.5,2.5,3.5
S-3356-15,3.5,2.5,2.5,3.5
S-3357-01,4,3,3,4
S-3357-02,3,2,2,3
S-3357-03,4,3,3,4
S-3357-04,4,3,3,4
S-3357-05,4,3,3,4
S-3357-06,4,3,3,4
S-3357-07,4,3,3,4
S-3357-08,4,3,3,4
S-3357-09,3.75,2.75,2.75,3.75
S-3358-01,3.75,2.75,2.75,3.75
S-3358-02,3.5,2.5,2.5,3.5
S-3358-03,2.5,1.5,1.5,2.5
S-3358-04,2.5,1.5,1.5,2.5
S-3358-05,2.5,1.5,1.5,2.5
S-3358-06,4,3,3,4
S-3358-07,2,1.5,1.5,2
S-3358-08,2,1.5,1.5,2
S-3358-09,3.5,2.5,2.5,3.5
S-3358-10,4,3,3,4
S-3358-11,3.5,2.5,2.5,3.5
S-3358-12,4,3,3,4
S-3358-13,4,3,3,4
S-3358-14,2.5,1.5,1.5,2.5
S-3358-15,2.5,1.5,1.5,2.5
S-3359-01,2.5,1.5,1.5,2.5
S-3359-02,2.5,1.5,1.5,2.5
S-3359-03,3,2,2,3
S-3359-04,2.5,1.5,1.5,2.5
S-3359-05,2,1.5,1.5,2
S-3359-06,3.75,2.75,2.75,3.75
S-3359-07,3.5,2.5,2.5,3.5
S-3359-08,4,3,3,4
S-3359-09,3.75,2.75,2.75,3.75
S-3359-10,3.75,2.75,2.75,3.75
S-3359-11,4,3,3,4
S-3359-12,3.5,2.5,2.5,3.5
S-3359-13,2.5,1.5,1.5,2.5
S-3359-14,2.5,1.5,1.5,2.5
S-3360-01,2,1.5,1.5,2
S-3360-02,3,2,2,3
S-3360-03,2.5,1.5,1.5,2.5
S-3360-04,3,2,2,3
S-3360-05,3,2,2,3
S-3360-06,3.5,2.5,2.5,3.5
S-3360-07,3.5,2.5,2.5,3.5
S-3360-08,3.5,2.5,2.5,3.5
S-3360-09,3,2,2,3
S-3360-10,3.5,2.5,2.5,3.5
S-3360-11,3.5,2.5,2.5,3.5
S-3360-12,4,3,3,4
S-3360-13,3,2,2,3
S-3361-01,3,2,2,3
S-3361-02,3,2,2,3
S-3361-03,3.5,2.5,2.5,3.5
S-3361-04,3.5,2.5,2.5,3.5
S-3361-05,4,3,3,4
S-3361-06,2.5,1.5,1.5,2.5
S-3361-07,4,3,3,4
S-3361-08,4,3,3,4
S-3361-09,3,2,2,3
S-3361-10,1,0.5,0.5,1
S-3361-11,1,0.5,0.5,1
S-3362-01,2,1.5,1.5,2
S-3362-02,2.5,1.5,1.5,2.5
S-3362-03,3.5,2.5,2.5,3.5
S-3362-04,3.5,2.5,2.5,3.5
S-3362-05,3.5,2.5,2.5,3.5
S-3362-06,2.5,1.5,1.5,2.5
S-3362-07,2,1.5,1.5,2
S-3362-08,3.5,2.5,2.5,3.5
S-3362-09,3,2,2,3
S-3362-10,3.5,2.5,2.5,3.5
S-3362-11,2.5,1.5,1.5,2.5
S-3362-12,3.5,2.5,2.5,3.5
S-3363-01,4,3,3,4
S-3363-02,4,3,3,4
S-3363-03,4,3,3,4
S-3363-04,4,3,3,4
S-3363-05,4,3,3,4
S-3363-06,3.5,2.5,2.5,3.5
S-3363-07,3.5,2.5,2.5,3.5
S-3363-08,2.5,1.5,1.5,2.5
S-3363-09,3,2,2,3
S-3363-10,3.75,2.75,2.75,3.75
S-3363-11,3.5,2.5,2.5,3.5
S-3364-01,2.5,1.5,1.5,2.5
S-3364-02,2.5,1.5,1.5,2.5
S-3364-03,3.75,2.75,2.75,3.75
S-3364-04,3.75,2.75,2.75,3.75
S-3364-05,3,2,2,3
S-3364-06,3.5,2.5,2.5,3.5
S-3364-07,3.5,2.5,2.5,3.5
S-3364-08,4,3,3,4
S-3364-09,2.5,1.5,1.5,2.5
S-3364-10,3,2,2,3
S-3364-11,3.5,2.5,2.5,3.5
S-3364-12,4,3,3,4
S-3364-13,4,3,3,4
S-3365-01,2.75,2,2,2.75
S-3365-02,2.5,1.5,1.5,2.5
S-3365-03,2.5,1.5,1.5,2.5
S-3365-04,4,3,3,4
S-3365-05,3.5,2.5,2.5,3.5
S-3365-06,3.5,2.5,2.5,3.5
S-3365-07,2.5,1.5,1.5,2.5
S-3365-08,2.5,1.5,1.5,2.5
S-3365-09,2.5,1.5,1.5,2.5
S-3365-10,2.5,1.5,1.5,2.5
S-3365-11,3,2,2,3
S-3365-12,4,3,3,4
S-3366-01,0.5,0,0,0.5
S-3366-02,1,0.5,0.5,1
S-3366-03,1,0.5,0.5,1
S-3366-04,0.5,0,0,0.5
S-3366-05,1,0.5,0.5,1
S-3366-06,1.5,1,1,1.5
S-3366-07,1.5,1,1,1.5
S-3366-08,1.5,1,1,1.5
S-3366-09,2,1.5,1.5,2
S-3366-10,1.5,1,1,1.5
S-3366-11,1,0.5,0.5,1
S-3366-12,1.5,1,1,1.5
S-3366-13,3,2,2,3
S-3366-14,1,0.5,0.5,1
S-3366-15,1,0.5,0.5,1
S-3367-01,3.5,2.5,2.5,3.5
S-3367-02,2.5,1.5,1.5,2.5
S-3367-03,3,2,2,3
S-3367-04,4,3,3,4
S-3367-05,2.5,1.5,1.5,2.5
S-3367-06,2.5,1.5,1.5,2.5
S-3367-07,2.5,1.5,1.5,2.5
S-3367-08,2.5,1.5,1.5,2.5
S-3367-09,2.5,1.5,1.5,2.5
S-3367-10,2.5,1.5,1.5,2.5
S-3367-11,2.5,1.5,1.5,2.5
S-3367-12,3.5,2.5,2.5,3.5
S-3367-13,2,1.5,1.5,2
S-3367-14,2,1.5,1.5,2
S-3367-15,3.5,2.5,2.5,3.5
S-3368-01,3,2,2,3
S-3368-02,4,3,3,4
S-3368-03,3.5,2.5,2.5,3.5
S-3368-04,2.5,1.5,1.5,2.5
S-3368-05,2,1,1,2
S-3368-06,2,1,1,2
S-3368-07,3,2,2,3
S-3368-08,3.5,2.5,2.5,3.5
S-3368-09,2,1.5,1.5,2
S-3368-10,2,1.5,1.5,2
S-3368-11,2,1.5,1.5,2
S-3368-12,2,1.5,1.5,2
S-3368-13,2,1.5,1.5,2
S-3368-14,2,1.5,1.5,2
S-3370-01,2.5,1.5,1.5,2.5
S-3370-02,2.5,1.5,1.5,2.5
S-3370-03,2.5,1.5,1.5,2.5
S-3370-04,2.5,1.5,1.5,2.5
S-3370-05,3,2,2,3
S-3370-06,2.5,1.5,1.5,2.5
S-3370-07,2.5,1.5,1.5,2.5
S-3370-08,3.5,2.5,2.5,3.5
S-3370-09,2.5,1.5,1.5,2.5
S-3370-10,2,1.5,1.5,2
S-3370-11,3.5,2.5,2.5,3.5
S-3370-12,3.5,2.5,2.5,3.5
S-3371-01,3.5,2.5,2.5,3.5
S-3371-02,3.5,2.5,2.5,3.5
S-3371-03,3.5,2.5,2.5,3.5
S-3371-04,4,3,3,4
S-3371-05,4,3,3,4
S-3371-06,4,3,3,4
S-3371-07,2.5,1.5,1.5,2.5
S-3372-01,2.5,1.5,1.5,2.5
S-3372-02,3,2,2,3
S-3372-03,3,2,2,3
S-3372-04,3,2,2,3
S-3372-05,3.5,2.5,2.5,3.5
S-3372-06,4,3,3,4
S-3372-07,3,2,2,3
S-3372-08,4,3,3,4
S-3372-09,4,3,3,4
S-3373-01,4,3,3,4
S-3373-02,3.5,2.5,2.5,3.5
S-3373-03,3.5,2.5,2.5,3.5
S-3373-04,3.5,2.5,2.5,3.5
S-3373-05,3.5,2.5,2.5,3.5
S-3373-06,3.75,2.5,2.75,3.75
S-3373-07,3.75,2.5,2.75,3.75
S-3373-08,3,2,2,3
S-3373-09,3.5,2.5,2.5,3.5
S-3373-10,3,2,2,3
S-3373-11,3.5,2.5,2.5,3.5
S-3373-12,3.75,2.5,2.75,3.75
S-3373-13,3.5,2.5,2.5,3.5
S-3374-01,2.5,1.5,1.5,2.5
S-3374-02,2.5,1.5,1.5,2.5
S-3374-03,2.5,1.5,1.5,2.5
S-3374-04,3,2,2,3
S-3374-05,2.5,1.5,1.5,2.5
S-3374-06,2.75,2,2,2.75
S-3374-07,2.75,2,2,2.75
S-3374-08,3.5,2.5,2.5,3.5
S-3374-09,4,3,3,4
S-3374-10,4,3,3,4
S-3375-01,3.75,2.5,2.75,3.75
S-3375-02,2.5,1.5,1.5,2.5
S-3375-03,4,3,3,4
S-3375-04,3.75,2.5,2.75,3.75
S-3375-05,4,3,3,4
S-3375-06,4,3,3,4
S-3376-01,0.5,0,0,0.5
S-3376-02,1,0.5,0.5,1
S-3376-03,1,0.5,0.5,1
S-3376-04,1.5,1,1,1.5
S-3376-05,1.5,1,1,1.5
S-3376-06,0.5,0,0,0.5
S-3376-07,0.5,0,0,0.5
S-3376-08,1,0.5,0.5,1
S-3376-09,1,0.5,0.5,1
S-3376-10,1.5,1,1,1.5
S-3376-11,0.5,0,0,0.5
S-3376-12,0.5,0,0,0.5
S-3376-13,0.5,0,0,0.5
S-3376-14,0.5,0,0,0.5
S-3376-15,1,0.5,0.5,1
"""

# Parse the data
rows = [line.split(',') for line in raw_data.strip().split('\n')]
df = pd.DataFrame(rows, columns=['id', 'architecture', 'atrophy', 'complexes', 'fibrosis'])

# Convert the ID "S-3349-01" to the exact filename "S-3349-10X_Image001_ch00.tif"
# Logic: Split S-3349-01 into "S-3349" and "01". Then pad "01" to "001".
def convert_to_filename(row_id):
    parts = row_id.split('-')
    if len(parts) < 3: return row_id # Safety check
    
    experiment_id = f"{parts[0]}-{parts[1]}" # S-3349
    image_num = parts[2] # 01
    
    # Pad number with zeros to be length 3 (e.g., "01" -> "001")
    padded_num = image_num.zfill(3)
    
    return f"{experiment_id}-10X_Image{padded_num}_ch00.tif"

df['filename'] = df['id'].apply(convert_to_filename)

# Reorder columns
final_df = df[['filename', 'architecture', 'atrophy', 'complexes', 'fibrosis']]

# Save to CSV
final_df.to_csv('dataset/labels.csv', index=False)
print("Success! 'labels.csv' created with", len(final_df), "entries.")
print("First 5 rows:")
print(final_df.head())